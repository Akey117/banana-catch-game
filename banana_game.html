
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banana Catch</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #DDA0DD 0%, #E6E6FA 100%);
            font-family: 'Comic Sans MS', cursive, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            color: black;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.5);
            margin-bottom: 10px;
        }

        #gameContainer {
            position: relative;
            width: 800px;
            height: 600px;
            background: linear-gradient(to bottom, #87CEEB 0%, #90EE90 100%);
            overflow: hidden;
            max-width: 100vw;
            max-height: 80vh;
        }

        /* Mobile responsive styles */
        @media (max-width: 850px) {
            #gameContainer {
                width: 95vw;
                height: 60vh;
            }
            
            #gameCanvas {
                width: 100%;
                height: 100%;
            }
            
            #gameInfo {
                width: 95vw;
                font-size: 16px;
            }
            
            #instructions {
                font-size: 14px;
                padding: 0 10px;
            }
        }

        #gameCanvas {
            display: block;
            background: transparent;
        }

        #gameInfo {
            display: flex;
            justify-content: space-between;
            width: 800px;
            margin-top: 10px;
            font-size: 18px;
            font-weight: bold;
            color: black;
        }

        #startButton {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 15px 30px;
            font-size: 24px;
            background: #FFD700;
            border: 3px solid #FFA500;
            border-radius: 15px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            color: #8B4513;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: transform 0.1s;
        }

        #startButton:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        #startButton:active {
            transform: translate(-50%, -50%) scale(0.95);
        }

        #instructions {
            text-align: center;
            margin-top: 15px;
            color: black;
            font-size: 16px;
        }

        .cloud {
            position: absolute;
            background: white;
            border-radius: 50px;
            opacity: 0.8;
            animation: float 20s infinite linear;
        }

        .cloud:before {
            content: '';
            position: absolute;
            background: white;
            border-radius: 50px;
        }

        .cloud1 {
            width: 80px;
            height: 30px;
            top: 50px;
            left: -100px;
        }

        .cloud1:before {
            width: 40px;
            height: 40px;
            top: -15px;
            left: 15px;
        }

        .cloud2 {
            width: 60px;
            height: 25px;
            top: 100px;
            left: -80px;
            animation-delay: -10s;
        }

        .cloud2:before {
            width: 30px;
            height: 30px;
            top: -10px;
            left: 10px;
        }

        @keyframes float {
            from { transform: translateX(0); }
            to { transform: translateX(900px); }
        }
    </style>
</head>
<body>

    
    <div id="gameContainer">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <button id="startButton">Start Game!</button>
        
        <!-- Floating clouds -->
        <div class="cloud cloud1"></div>
        <div class="cloud cloud2"></div>
    </div>
    
    <div id="gameInfo">
        <div>Score: <span id="score">0</span></div>
        <div>Lives: <span id="lives">10</span></div>
        <div>Level: <span id="level">1</span></div>
    </div>
    
    <div id="instructions">
        Catch the falling bananas and avoid letting them hit the ground!<br>
        <strong>Desktop:</strong> Use LEFT & RIGHT arrow keys to move the monkey and its basket!<br>
        <strong>Mobile:</strong> Drag left/right on screen to move the monkey and its basket!<br>
        Catch 10 and skip ahead to victory dance with your giant banana...<br>
        or move on to level two and start catching dollar bills!
    </div>

    <script>
        class BananaCatchingGame {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.startButton = document.getElementById('startButton');
                
                // Game state
                this.gameRunning = false;
                this.score = 0;
                this.lives = 10;
                this.level = 1;
                this.gameMode = 'catching'; // 'catching', 'choice', 'victory', 'cashapp'
                this.victoryPhase = 0; // 0: walking, 1: climbing, 2: swinging, 3: hugging, 4: dancing
                this.animationTime = 0;
                this.monkeyExpression = 'neutral'; // 'neutral', 'happy', 'sad'
                this.expressionTimer = 0;
                this.dollarBills = [];
                this.totalMoney = 0;
                
                // Game objects
                this.monkey = {
                    x: 300,
                    y: 380,
                    width: 100,
                    height: 120,
                    speed: 8
                };
                
                this.basket = {
                    x: 320,
                    y: 520,
                    width: 80,
                    height: 40,
                    speed: 8
                };
                
                this.bananas = [];
                this.particles = [];
                this.dollarRain = []; // Continuous dollar rain animation
                
                // Input handling
                this.keys = {};
                
                this.init();
            }
            
            init() {
                this.startButton.addEventListener('click', () => this.startGame());
                
                // Touch events for mobile
                this.setupTouchControls();
                
                // Keyboard events
                document.addEventListener('keydown', (e) => {
                    this.keys[e.key.toLowerCase()] = true;
                    
                    // Handle spacebar for tree swinging
                    if (e.code === 'Space' && this.gameMode === 'victory' && (this.victoryPhase === 2 || this.victoryPhase === 3)) {
                        e.preventDefault();
                        this.handleTreeJump();
                    }
                    
                    // Handle Command+B to jump to victory dance
                    if ((e.metaKey || e.ctrlKey) && e.key.toLowerCase() === 'b') {
                        e.preventDefault();
                        this.startVictorySequence();
                    }
                    
                    // Handle Command+E to jump to level 2 ending
                    if ((e.metaKey || e.ctrlKey) && e.key.toLowerCase() === 'e') {
                        e.preventDefault();
                        this.startCashAppEnding();
                    }
                    
                    // Handle spacebar to exit messages
                    if (e.code === 'Space') {
                        // Close choice popup
                        const choicePopup = document.getElementById('choicePopup');
                        if (choicePopup) {
                            e.preventDefault();
                            document.body.removeChild(choicePopup);
                            this.gameRunning = true;
                            this.gameMode = 'catching';
                        }
                        
                        // Close level 2 popup
                        const level2Popup = document.getElementById('level2Popup');
                        if (level2Popup) {
                            e.preventDefault();
                            document.body.removeChild(level2Popup);
                            this.gameRunning = true;
                            this.gameMode = 'catching';
                        }
                        
                        // Close cash app popup
                        const cashAppPopup = document.getElementById('cashAppPopup');
                        if (cashAppPopup) {
                            e.preventDefault();
                            document.body.removeChild(cashAppPopup);
                            this.startWinkAnimation();
                        }
                    }
                });
                
                document.addEventListener('keyup', (e) => {
                    this.keys[e.key.toLowerCase()] = false;
                });
                
                this.gameLoop();
            }
            
            setupTouchControls() {
                // Touch controls for mobile devices
                let touchStartX = 0;
                let touchStartY = 0;
                let isTouching = false;
                
                // Touch start
                this.canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    touchStartX = touch.clientX;
                    touchStartY = touch.clientY;
                    isTouching = true;
                }, { passive: false });
                
                // Touch move for continuous movement
                this.canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    if (!isTouching || !this.gameRunning) return;
                    
                    const touch = e.touches[0];
                    const currentX = touch.clientX;
                    const deltaX = currentX - touchStartX;
                    
                    // Move monkey based on touch movement
                    if (Math.abs(deltaX) > 10) { // Minimum movement threshold
                        if (deltaX > 0 && this.monkey.x < this.canvas.width - this.monkey.width) {
                            // Moving right
                            this.monkey.x += this.monkey.speed;
                            this.basket.x = this.monkey.x + 20;
                        } else if (deltaX < 0 && this.monkey.x > 0) {
                            // Moving left
                            this.monkey.x -= this.monkey.speed;
                            this.basket.x = this.monkey.x + 20;
                        }
                        touchStartX = currentX; // Update start position for continuous movement
                    }
                }, { passive: false });
                
                // Touch end
                this.canvas.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    isTouching = false;
                }, { passive: false });
                
                // Tap controls for game actions
                this.canvas.addEventListener('touchstart', (e) => {
                    if (e.touches.length === 1) {
                        const touch = e.touches[0];
                        const rect = this.canvas.getBoundingClientRect();
                        const tapX = touch.clientX - rect.left;
                        const tapY = touch.clientY - rect.top;
                        
                        // Handle spacebar-like actions with tap
                        if (this.gameMode === 'victory' && (this.victoryPhase === 2 || this.victoryPhase === 3)) {
                            this.handleTreeJump();
                        }
                        
                        // Close popups with tap
                        const choicePopup = document.getElementById('choicePopup');
                        if (choicePopup) {
                            document.body.removeChild(choicePopup);
                            this.gameRunning = true;
                            this.gameMode = 'catching';
                        }
                        
                        const level2Popup = document.getElementById('level2Popup');
                        if (level2Popup) {
                            document.body.removeChild(level2Popup);
                            this.gameRunning = true;
                            this.gameMode = 'catching';
                        }
                        
                        const cashAppPopup = document.getElementById('cashAppPopup');
                        if (cashAppPopup) {
                            document.body.removeChild(cashAppPopup);
                            this.startWinkAnimation();
                        }
                    }
                });
                
                // Prevent default touch behaviors on the canvas
                this.canvas.addEventListener('touchstart', (e) => e.preventDefault(), { passive: false });
                this.canvas.addEventListener('touchmove', (e) => e.preventDefault(), { passive: false });
                this.canvas.addEventListener('touchend', (e) => e.preventDefault(), { passive: false });
            }
            
            startGame() {
                this.gameRunning = true;
                this.score = 0;
                this.lives = 10;
                this.level = 1;
                this.bananas = [];
                this.dollarBills = [];
                this.totalMoney = 0;
                this.particles = [];
                this.monkey.x = 300;
                this.basket.x = 320;
                this.startButton.style.display = 'none';
                this.updateUI();
            }
            
            spawnBanana() {
                // Only spawn bananas in level 1
                if (this.level === 1) {
                    const spawnRate = 0.008 + (this.level * 0.002);
                    if (Math.random() < spawnRate) {
                        this.bananas.push({
                            x: Math.random() * (this.canvas.width - 60),
                            y: -60,
                            width: 60,
                            height: 60,
                            speed: 1 + (this.level * 0.2),
                            rotation: 0
                        });
                    }
                }
            }
            
            spawnDollarBill() {
                // Only spawn dollar bills in level 2
                if (this.level === 2) {
                    const spawnRate = 0.008 + (this.level * 0.002);
                    if (Math.random() < spawnRate) {
                        this.dollarBills.push({
                            x: Math.random() * (this.canvas.width - 40),
                            y: -40,
                            width: 40,
                            height: 40,
                            speed: 1 + (this.level * 0.2),
                            rotation: 0,
                            value: 1 // Each dollar bill is worth $1
                        });
                    }
                }
            }
            
            updateBasket() {
                // Move monkey and basket together based on input
                if ((this.keys['arrowleft'] || this.keys['a']) && this.monkey.x > 0) {
                    this.monkey.x -= this.monkey.speed;
                    this.basket.x = this.monkey.x + 20; // Basket follows monkey
                }
                if ((this.keys['arrowright'] || this.keys['d']) && this.monkey.x < this.canvas.width - this.monkey.width) {
                    this.monkey.x += this.monkey.speed;
                    this.basket.x = this.monkey.x + 20; // Basket follows monkey
                }
            }
            
            updateBananas() {
                for (let i = this.bananas.length - 1; i >= 0; i--) {
                    const banana = this.bananas[i];
                    banana.y += banana.speed;
                    banana.rotation += 0.1;
                    
                    // Check collision with basket
                    if (banana.x < this.basket.x + this.basket.width &&
                        banana.x + banana.width > this.basket.x &&
                        banana.y < this.basket.y + this.basket.height &&
                        banana.y + banana.height > this.basket.y) {
                        
                        // Caught banana!
                        this.score += 10;
                        this.createParticles(banana.x + banana.width/2, banana.y + banana.height/2, '#FFD700');
                        this.bananas.splice(i, 1);
                        
                        // Happy expression when catching banana
                        this.monkeyExpression = 'happy';
                        this.expressionTimer = 60; // Show for 1 second (60 frames)
                        
                        // Check for level 2 at 200 points (20 bananas)
                        if (this.score === 200 && this.level === 1) {
                            this.level = 2;
                            this.showLevel2Popup();
                        }
                        
                        // Check for choice at 100 points (10 bananas) only in level 1
                        if (this.score === 100 && this.level === 1) {
                            this.showChoicePopup();
                        }
                        
                        this.updateUI();
                        continue;
                    }
                    
                    // Check if banana hit the ground
                    if (banana.y > this.canvas.height) {
                        this.lives--;
                        this.createParticles(banana.x + banana.width/2, this.canvas.height - 20, '#FF6B6B');
                        this.bananas.splice(i, 1);
                        
                        // Sad expression when banana falls
                        this.monkeyExpression = 'sad';
                        this.expressionTimer = 120; // Show for 2 seconds (120 frames)
                        
                        if (this.lives <= 0) {
                            this.gameOver();
                        }
                        
                        this.updateUI();
                    }
                }
            }
            
            updateDollarBills() {
                for (let i = this.dollarBills.length - 1; i >= 0; i--) {
                    const dollarBill = this.dollarBills[i];
                    dollarBill.y += dollarBill.speed;
                    dollarBill.rotation += 0.05; // Slower rotation than bananas
                    
                    // Check collision with basket
                    if (dollarBill.x < this.basket.x + this.basket.width &&
                        dollarBill.x + dollarBill.width > this.basket.x &&
                        dollarBill.y < this.basket.y + this.basket.height &&
                        dollarBill.y + dollarBill.height > this.basket.y) {
                        
                        // Caught dollar bill!
                        this.totalMoney += dollarBill.value;
                        this.score += 10; // Score increases when dollars are collected
                        this.createParticles(dollarBill.x + dollarBill.width/2, dollarBill.y + dollarBill.height/2, '#00FF00');
                        this.dollarBills.splice(i, 1);
                        
                        // Happy expression when catching money
                        this.monkeyExpression = 'happy';
                        this.expressionTimer = 60; // Show for 1 second (60 frames)
                        
                        // Check for game ending at 25 dollar bills
                        if (this.totalMoney >= 25) {
                            this.startCashAppEnding();
                        }
                        
                        this.updateUI();
                        continue;
                    }
                    
                    // Check if dollar bill hit the ground
                    if (dollarBill.y > this.canvas.height) {
                        this.lives--;
                        this.createParticles(dollarBill.x + dollarBill.width/2, this.canvas.height - 20, '#FF6B6B');
                        this.dollarBills.splice(i, 1);
                        
                        // Sad expression when money falls
                        this.monkeyExpression = 'sad';
                        this.expressionTimer = 120; // Show for 2 seconds (120 frames)
                        
                        if (this.lives <= 0) {
                            this.gameOver();
                        }
                        
                        this.updateUI();
                    }
                }
            }
            
            createParticles(x, y, color) {
                for (let i = 0; i < 8; i++) {
                    this.particles.push({
                        x: x,
                        y: y,
                        vx: (Math.random() - 0.5) * 8,
                        vy: (Math.random() - 0.5) * 8,
                        life: 30,
                        color: color
                    });
                }
            }
            
            updateParticles() {
                for (let i = this.particles.length - 1; i >= 0; i--) {
                    const particle = this.particles[i];
                    particle.x += particle.vx;
                    particle.y += particle.vy;
                    particle.life--;
                    
                    if (particle.life <= 0) {
                        this.particles.splice(i, 1);
                    }
                }
            }
            
            drawMonkey() {
                const monkey = this.monkey;
                
                // Draw tail first (behind everything) - ATTACHED to body
                this.drawMonkeyTail(monkey.x, monkey.y);
                
                // Big ears ATTACHED to head (draw first so they're behind the head)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 20, monkey.y + 25, 22, 0, Math.PI * 2); // Left ear - bigger and closer to head
                this.ctx.arc(monkey.x + 80, monkey.y + 25, 22, 0, Math.PI * 2); // Right ear - bigger and closer to head
                this.ctx.fill();
                
                // Inner ears (pink) - bigger to match outer ears
                this.ctx.fillStyle = '#FFB6C1';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 20, monkey.y + 25, 15, 0, Math.PI * 2); // Left inner ear
                this.ctx.arc(monkey.x + 80, monkey.y + 25, 15, 0, Math.PI * 2); // Right inner ear
                this.ctx.fill();
                
                // Body (more monkey-like but shorter)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50, monkey.y + 65, 35, 35, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Chest (lighter color)
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50, monkey.y + 68, 20, 25, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Head (larger and more rounded)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 50, monkey.y + 35, 30, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Muzzle
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50, monkey.y + 45, 15, 12, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Nostrils
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 47, monkey.y + 42, 1.5, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 53, monkey.y + 42, 1.5, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eyes (larger and more expressive)
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 42, monkey.y + 30, 6, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 58, monkey.y + 30, 6, 0, Math.PI * 2);
                this.ctx.fill();
                
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 43, monkey.y + 30, 3, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 57, monkey.y + 30, 3, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eye highlights
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 44, monkey.y + 29, 1, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 58, monkey.y + 29, 1, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Facial expression based on game state
                this.ctx.strokeStyle = 'black';
                this.ctx.lineWidth = 2;
                if (this.monkeyExpression === 'happy') {
                    // Happy smile
                    this.ctx.beginPath();
                    this.ctx.arc(monkey.x + 50, monkey.y + 48, 10, 0, Math.PI);
                    this.ctx.stroke();
                } else if (this.monkeyExpression === 'sad') {
                    // Sad frown
                    this.ctx.beginPath();
                    this.ctx.arc(monkey.x + 50, monkey.y + 52, 8, Math.PI, 0);
                    this.ctx.stroke();
                } else {
                    // Neutral expression
                    this.ctx.beginPath();
                    this.ctx.moveTo(monkey.x + 42, monkey.y + 50);
                    this.ctx.lineTo(monkey.x + 58, monkey.y + 50);
                    this.ctx.stroke();
                }
                
                // Arms holding the basket
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 8;
                
                // Left arm (holding phone)
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 20, monkey.y + 60);
                this.ctx.quadraticCurveTo(monkey.x + 5, monkey.y + 75, monkey.x - 10, monkey.y + 85);
                this.ctx.stroke();
                
                // Right arm (holding basket)
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 80, monkey.y + 60);
                this.ctx.quadraticCurveTo(monkey.x + 90, monkey.y + 80, this.basket.x + this.basket.width + 5, this.basket.y + 10);
                this.ctx.stroke();
                
                // Left hand holding phone
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x - 10, monkey.y + 85, 8, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Phone in left hand - CLOSER to monkey
                this.drawPhoneWithCashApp(monkey.x - 15, monkey.y + 80);
                
                // Right hand holding basket
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(this.basket.x + this.basket.width + 5, this.basket.y + 10, 8, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Legs - CONNECTED to body and extending to feet
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 6;
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 35, monkey.y + 100); // Start from body bottom
                this.ctx.lineTo(monkey.x + 30, monkey.y + 135); // Extend to feet
                this.ctx.moveTo(monkey.x + 65, monkey.y + 100); // Start from body bottom
                this.ctx.lineTo(monkey.x + 70, monkey.y + 135); // Extend to feet
                this.ctx.stroke();
                
                // Feet - positioned at bottom of legs
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 30, monkey.y + 140, 12, 6, 0, 0, Math.PI * 2);
                this.ctx.ellipse(monkey.x + 70, monkey.y + 140, 12, 6, 0, 0, Math.PI * 2);
                this.ctx.fill();
            }
            
            drawMonkeyTail(monkeyX, monkeyY) {
                // Draw animated curvy monkey tail
                const tailTime = Date.now() * 0.003; // Slow animation
                const tailSway = Math.sin(tailTime) * 15; // Sway left and right
                const tailCurl = Math.sin(tailTime * 1.5) * 10; // Curl motion
                
                // Tail base position (ATTACHED to monkey's body)
                const tailBaseX = monkeyX + 75; // Attached to right side of monkey body
                const tailBaseY = monkeyY + 85; // Attached to middle of monkey body
                
                // Tail segments for curved appearance
                this.ctx.strokeStyle = '#8B4513';
                this.ctx.lineWidth = 8;
                this.ctx.lineCap = 'round';
                
                // Draw tail as a curved path with multiple segments
                this.ctx.beginPath();
                this.ctx.moveTo(tailBaseX, tailBaseY);
                
                // First curve (upward and back)
                this.ctx.quadraticCurveTo(
                    tailBaseX + 20 + tailSway, 
                    tailBaseY - 20 + tailCurl, 
                    tailBaseX + 35 + tailSway, 
                    tailBaseY - 10
                );
                
                // Second curve (downward curl)
                this.ctx.quadraticCurveTo(
                    tailBaseX + 50 + tailSway * 1.5, 
                    tailBaseY + 10 + tailCurl, 
                    tailBaseX + 45 + tailSway * 2, 
                    tailBaseY + 30 + tailCurl * 1.5
                );
                
                // Final curl (upward tip)
                this.ctx.quadraticCurveTo(
                    tailBaseX + 35 + tailSway * 2, 
                    tailBaseY + 45 + tailCurl * 2, 
                    tailBaseX + 25 + tailSway * 2.5, 
                    tailBaseY + 35 + tailCurl * 2
                );
                
                this.ctx.stroke();
                
                // Tail tip (darker color)
                this.ctx.fillStyle = '#654321';
                this.ctx.beginPath();
                this.ctx.arc(
                    tailBaseX + 25 + tailSway * 2.5, 
                    tailBaseY + 35 + tailCurl * 2, 
                    4, 0, Math.PI * 2
                );
                this.ctx.fill();
            }
            
            drawMonkeyTailScaled(offsetX, offsetY, scale) {
                // Draw animated curvy monkey tail for scaled contexts
                const tailTime = Date.now() * 0.003; // Slow animation
                const tailSway = Math.sin(tailTime) * 12; // Sway left and right (scaled down)
                const tailCurl = Math.sin(tailTime * 1.5) * 8; // Curl motion (scaled down)
                
                // Tail base position (ATTACHED to monkey's body in scaled coordinates)
                const tailBaseX = 65 + offsetX; // Attached to right side of monkey body in scaled space
                const tailBaseY = 60 + offsetY; // Attached to middle of monkey body in scaled space
                
                // Tail segments for curved appearance
                this.ctx.strokeStyle = '#8B4513';
                this.ctx.lineWidth = 6;
                this.ctx.lineCap = 'round';
                
                // Draw tail as a curved path with multiple segments
                this.ctx.beginPath();
                this.ctx.moveTo(tailBaseX, tailBaseY);
                
                // First curve (upward and back)
                this.ctx.quadraticCurveTo(
                    tailBaseX + 15 + tailSway, 
                    tailBaseY - 15 + tailCurl, 
                    tailBaseX + 25 + tailSway, 
                    tailBaseY - 8
                );
                
                // Second curve (downward curl)
                this.ctx.quadraticCurveTo(
                    tailBaseX + 35 + tailSway * 1.2, 
                    tailBaseY + 8 + tailCurl, 
                    tailBaseX + 32 + tailSway * 1.5, 
                    tailBaseY + 20 + tailCurl * 1.2
                );
                
                // Final curl (upward tip)
                this.ctx.quadraticCurveTo(
                    tailBaseX + 25 + tailSway * 1.5, 
                    tailBaseY + 30 + tailCurl * 1.5, 
                    tailBaseX + 18 + tailSway * 2, 
                    tailBaseY + 25 + tailCurl * 1.5
                );
                
                this.ctx.stroke();
                
                // Tail tip (darker color)
                this.ctx.fillStyle = '#654321';
                this.ctx.beginPath();
                this.ctx.arc(
                    tailBaseX + 18 + tailSway * 2, 
                    tailBaseY + 25 + tailCurl * 1.5, 
                    3, 0, Math.PI * 2
                );
                this.ctx.fill();
            }
            
            drawPhoneWithCashApp(x, y) {
                // Phone body (black rectangle with rounded corners)
                this.ctx.fillStyle = '#2C2C2C';
                this.ctx.beginPath();
                this.ctx.roundRect(x, y, 20, 35, 3);
                this.ctx.fill();
                
                // Phone screen (slightly smaller rectangle)
                this.ctx.fillStyle = '#000000';
                this.ctx.beginPath();
                this.ctx.roundRect(x + 2, y + 3, 16, 29, 2);
                this.ctx.fill();
                
                // Cash App logo background (green screen)
                this.ctx.fillStyle = '#00D632';
                this.ctx.beginPath();
                this.ctx.roundRect(x + 3, y + 4, 14, 27, 1);
                this.ctx.fill();
                
                // Cash App logo - white $ symbol
                this.ctx.fillStyle = 'white';
                this.ctx.font = 'bold 12px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.textBaseline = 'middle';
                this.ctx.fillText('$', x + 10, y + 17);
                
                // Home button
                this.ctx.fillStyle = '#444444';
                this.ctx.beginPath();
                this.ctx.arc(x + 10, y + 30, 2, 0, Math.PI * 2);
                this.ctx.fill();
            }
            
            drawPartyHat(x, y, scale = 1) {
                // Draw white triangle party hat with red pom pom on top of monkey's head
                this.ctx.save();
                this.ctx.translate(x, y);
                this.ctx.scale(scale, scale);
                
                // Hat base (white triangle)
                this.ctx.fillStyle = 'white';
                this.ctx.strokeStyle = '#E0E0E0';
                this.ctx.lineWidth = 1;
                this.ctx.beginPath();
                this.ctx.moveTo(0, -25); // Top point
                this.ctx.lineTo(-15, 5);  // Bottom left
                this.ctx.lineTo(15, 5);   // Bottom right
                this.ctx.closePath();
                this.ctx.fill();
                this.ctx.stroke();
                
                // Hat brim (small curved line at bottom)
                this.ctx.strokeStyle = '#D0D0D0';
                this.ctx.lineWidth = 2;
                this.ctx.beginPath();
                this.ctx.moveTo(-15, 5);
                this.ctx.quadraticCurveTo(0, 8, 15, 5);
                this.ctx.stroke();
                
                // Red pom pom on top
                this.ctx.fillStyle = '#FF0000';
                this.ctx.beginPath();
                this.ctx.arc(0, -25, 4, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Pom pom highlight (to make it look fluffy)
                this.ctx.fillStyle = '#FF6666';
                this.ctx.beginPath();
                this.ctx.arc(-1, -26, 2, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Small sparkles around pom pom for party effect
                this.ctx.fillStyle = '#FFD700';
                for (let i = 0; i < 4; i++) {
                    const sparkleAngle = (i / 4) * Math.PI * 2;
                    const sparkleX = Math.cos(sparkleAngle) * 8;
                    const sparkleY = -25 + Math.sin(sparkleAngle) * 8;
                    
                    this.ctx.beginPath();
                    this.ctx.moveTo(sparkleX, sparkleY - 1);
                    this.ctx.lineTo(sparkleX + 1, sparkleY);
                    this.ctx.lineTo(sparkleX, sparkleY + 1);
                    this.ctx.lineTo(sparkleX - 1, sparkleY);
                    this.ctx.closePath();
                    this.ctx.fill();
                }
                
                this.ctx.restore();
            }
            
            drawBasket() {
                // First, hide the feet behind the basket by drawing a slightly larger background rectangle
                this.ctx.fillStyle = '#DEB887'; // Light brown color to match basket
                this.ctx.fillRect(this.basket.x - 5, this.basket.y - 5, this.basket.width + 10, this.basket.height + 15);
                
                // Basket body - LIGHT BROWN
                this.ctx.fillStyle = '#DEB887'; // Light brown color
                this.ctx.fillRect(this.basket.x, this.basket.y, this.basket.width, this.basket.height);
                
                // Basket weave pattern - darker brown
                this.ctx.strokeStyle = '#654321'; // Darker brown
                this.ctx.lineWidth = 2;
                for (let i = 0; i < 4; i++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.basket.x, this.basket.y + (i * 10));
                    this.ctx.lineTo(this.basket.x + this.basket.width, this.basket.y + (i * 10));
                    this.ctx.stroke();
                }
                for (let i = 0; i < 8; i++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.basket.x + (i * 10), this.basket.y);
                    this.ctx.lineTo(this.basket.x + (i * 10), this.basket.y + this.basket.height);
                    this.ctx.stroke();
                }
            }
            
            drawBananas() {
                this.bananas.forEach(banana => {
                    this.ctx.save();
                    this.ctx.translate(banana.x + banana.width/2, banana.y + banana.height/2);
                    this.ctx.rotate(banana.rotation);
                    
                    // Banana main body - MORE CURVED, NOT FAT - THINNER AND MORE CURVED
                    this.ctx.fillStyle = '#FFD700';
                    this.ctx.beginPath();
                    // Create a THINNER, MORE CURVED banana shape - NOT FAT
                    this.ctx.moveTo(-25, -3);
                    this.ctx.quadraticCurveTo(-20, -15, -5, -12);
                    this.ctx.quadraticCurveTo(8, -8, 15, -4);
                    this.ctx.quadraticCurveTo(25, -1, 28, 4);
                    this.ctx.quadraticCurveTo(26, 10, 18, 12);
                    this.ctx.quadraticCurveTo(6, 14, -5, 12);
                    this.ctx.quadraticCurveTo(-15, 10, -22, 6);
                    this.ctx.quadraticCurveTo(-28, 3, -25, -3);
                    this.ctx.fill();
                    
                    // Banana highlights (to make it look 3D and shiny) - BETTER CURVED SHAPE
                    this.ctx.fillStyle = '#FFFF99';
                    this.ctx.beginPath();
                    this.ctx.moveTo(-20, -1);
                    this.ctx.quadraticCurveTo(-15, -6, 0, -4);
                    this.ctx.quadraticCurveTo(12, -2, 18, 0);
                    this.ctx.quadraticCurveTo(20, 3, 15, 6);
                    this.ctx.quadraticCurveTo(8, 7, 0, 5);
                    this.ctx.quadraticCurveTo(-12, 3, -20, -1);
                    this.ctx.fill();
                    
                    // Banana ridges (the natural lines on a real banana) - CURVED TO FOLLOW SHAPE
                    this.ctx.strokeStyle = '#E6C200';
                    this.ctx.lineWidth = 1.5;
                    for (let i = -2; i <= 2; i++) {
                        this.ctx.beginPath();
                        this.ctx.moveTo(-23, i * 2.5);
                        // Make ridges follow the curved banana shape
                        this.ctx.quadraticCurveTo(-8, i * 2.5 - 2, 8, i * 2.5 - 1);
                        this.ctx.quadraticCurveTo(18, i * 2.5 + 1, 22, i * 2.5 + 2);
                        this.ctx.stroke();
                    }
                    
                    // Banana stem (brown tip at the top) - MORE REALISTIC
                    this.ctx.fillStyle = '#8B4513';
                    this.ctx.beginPath();
                    this.ctx.arc(-24, -1, 5, 0, Math.PI * 2);
                    this.ctx.fill();
                    this.ctx.fillStyle = '#654321';
                    this.ctx.beginPath();
                    this.ctx.arc(-24, -1, 2.5, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    // Banana bottom tip - MORE REALISTIC POINTED END
                    this.ctx.fillStyle = '#654321';
                    this.ctx.beginPath();
                    this.ctx.arc(22, 6, 3, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    // Add natural brown spots for realism - BETTER PLACEMENT
                    this.ctx.fillStyle = '#CD853F';
                    for (let i = 0; i < 5; i++) {
                        const spotX = -15 + (i * 7);
                        const spotY = -2 + Math.sin(i * 0.8) * 3;
                        this.ctx.beginPath();
                        this.ctx.arc(spotX, spotY, 1.2, 0, Math.PI * 2);
                        this.ctx.fill();
                    }
                    
                    // Add subtle darker edge for depth
                    this.ctx.strokeStyle = '#DAA520';
                    this.ctx.lineWidth = 1;
                    this.ctx.beginPath();
                    this.ctx.moveTo(-25, -2);
                    this.ctx.quadraticCurveTo(-20, -12, -5, -8);
                    this.ctx.quadraticCurveTo(8, -6, 20, -2);
                    this.ctx.quadraticCurveTo(25, 2, 22, 8);
                    this.ctx.quadraticCurveTo(15, 12, 5, 10);
                    this.ctx.quadraticCurveTo(-8, 8, -20, 6);
                    this.ctx.quadraticCurveTo(-25, 2, -25, -2);
                    this.ctx.stroke();
                    
                    this.ctx.restore();
                });
            }
            
            drawDollarBills() {
                this.dollarBills.forEach(dollarBill => {
                    this.ctx.save();
                    this.ctx.translate(dollarBill.x + dollarBill.width/2, dollarBill.y + dollarBill.height/2);
                    this.ctx.rotate(dollarBill.rotation);
                    
                    // Dollar bill main body (rectangular with rounded corners)
                    this.ctx.fillStyle = '#85BB65'; // Dollar bill green
                    this.ctx.strokeStyle = '#228B22';
                    this.ctx.lineWidth = 2;
                    this.ctx.beginPath();
                    this.ctx.roundRect(-18, -8, 36, 16, 3);
                    this.ctx.fill();
                    this.ctx.stroke();
                    
                    // Inner border (more prominent)
                    this.ctx.strokeStyle = '#006400';
                    this.ctx.lineWidth = 1.5;
                    this.ctx.beginPath();
                    this.ctx.roundRect(-16, -6, 32, 12, 2);
                    this.ctx.stroke();
                    
                    // LARGE prominent dollar sign (main feature)
                    this.ctx.fillStyle = '#006400';
                    this.ctx.strokeStyle = '#003300';
                    this.ctx.lineWidth = 1;
                    this.ctx.font = 'bold 20px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.textBaseline = 'middle';
                    this.ctx.strokeText('$', 0, 0);
                    this.ctx.fillText('$', 0, 0);
                    
                    // Corner dollar signs (smaller)
                    this.ctx.fillStyle = '#006400';
                    this.ctx.font = 'bold 8px Arial';
                    this.ctx.fillText('$', -12, -4);
                    this.ctx.fillText('$', 12, -4);
                    this.ctx.fillText('$', -12, 4);
                    this.ctx.fillText('$', 12, 4);
                    
                    // "ONE DOLLAR" text (small)
                    this.ctx.fillStyle = '#006400';
                    this.ctx.font = '4px Arial';
                    this.ctx.fillText('ONE', 0, -10);
                    this.ctx.fillText('DOLLAR', 0, 10);
                    
                    this.ctx.restore();
                });
            }
            
            drawParticles() {
                this.particles.forEach(particle => {
                    this.ctx.fillStyle = particle.color;
                    this.ctx.globalAlpha = particle.life / 30;
                    this.ctx.beginPath();
                    this.ctx.arc(particle.x, particle.y, 3, 0, Math.PI * 2);
                    this.ctx.fill();
                    this.ctx.globalAlpha = 1;
                });
            }
            
            drawBackground() {
                // Ground
                this.ctx.fillStyle = '#90EE90';
                this.ctx.fillRect(0, 550, this.canvas.width, 50);
                
                // Grass details
                this.ctx.strokeStyle = '#228B22';
                this.ctx.lineWidth = 2;
                for (let i = 0; i < this.canvas.width; i += 20) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(i, 550);
                    this.ctx.lineTo(i + 5, 545);
                    this.ctx.lineTo(i + 10, 550);
                    this.ctx.stroke();
                }
                
                // Draw much larger tree tops in background
                this.drawLargeTreeTops();
            }
            
            drawLargeTreeTops() {
                // Draw several large tree tops across the background
                const treePositions = [100, 250, 400, 550, 700];
                
                treePositions.forEach((x, index) => {
                    // Tree trunk (partially visible behind ground)
                    this.ctx.fillStyle = '#654321';
                    this.ctx.fillRect(x - 15, 480, 30, 70);
                    
                    // Much larger tree top with multiple layers
                    const baseSize = 120 + (index % 3) * 20; // Vary sizes: 120, 140, 160
                    const treeY = 450 - baseSize/2;
                    
                    // Bottom layer (darkest green)
                    this.ctx.fillStyle = '#228B22';
                    this.ctx.beginPath();
                    this.ctx.arc(x, treeY + 20, baseSize * 0.8, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    // Middle layer (medium green)
                    this.ctx.fillStyle = '#32CD32';
                    this.ctx.beginPath();
                    this.ctx.arc(x, treeY, baseSize * 0.9, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    // Top layer (brightest green)
                    this.ctx.fillStyle = '#90EE90';
                    this.ctx.beginPath();
                    this.ctx.arc(x, treeY - 15, baseSize, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    // Add some texture with smaller circles
                    this.ctx.fillStyle = '#228B22';
                    for (let i = 0; i < 8; i++) {
                        const angle = (i / 8) * Math.PI * 2;
                        const leafX = x + Math.cos(angle) * (baseSize * 0.7);
                        const leafY = treeY - 15 + Math.sin(angle) * (baseSize * 0.7);
                        this.ctx.beginPath();
                        this.ctx.arc(leafX, leafY, 15, 0, Math.PI * 2);
                        this.ctx.fill();
                    }
                });
            }
            
            showChoicePopup() {
                this.gameRunning = false;
                this.gameMode = 'choice';
                
                // Create choice popup
                const choiceDiv = document.createElement('div');
                choiceDiv.id = 'choicePopup';
                choiceDiv.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: white;
                    padding: 30px;
                    border: 4px solid #8B4513;
                    border-radius: 20px;
                    text-align: center;
                    z-index: 10000;
                    font-family: 'Comic Sans MS', cursive, sans-serif;
                    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
                `;
                
                choiceDiv.innerHTML = `
                    <h2 style="color: #8B4513; margin-bottom: 20px;">🎉 Amazing! You caught 10 bananas! 🍌</h2>
                    <p style="color: black; font-size: 18px; margin-bottom: 30px;">What would you like to do?</p>
                    <button id="continueBtn" style="
                        background: #4CAF50;
                        color: white;
                        border: none;
                        padding: 15px 30px;
                        margin: 10px;
                        border-radius: 10px;
                        font-size: 18px;
                        cursor: pointer;
                        font-family: inherit;
                    ">Keep Playing</button>
                    <button id="victoryBtn" style="
                        background: #FFD700;
                        color: #8B4513;
                        border: 3px solid #FFA500;
                        padding: 15px 30px;
                        margin: 10px;
                        border-radius: 10px;
                        font-size: 18px;
                        cursor: pointer;
                        font-family: inherit;
                        font-weight: bold;
                    ">Go to Victory Dance! 🌟</button>
                `;
                
                document.body.appendChild(choiceDiv);
                
                // Add event listeners
                document.getElementById('continueBtn').addEventListener('click', () => {
                    document.body.removeChild(choiceDiv);
                    this.gameRunning = true;
                    this.gameMode = 'catching';
                });
                
                document.getElementById('victoryBtn').addEventListener('click', () => {
                    document.body.removeChild(choiceDiv);
                    this.startVictorySequence();
                });
            }
            
            showLevel2Popup() {
                this.gameRunning = false;
                
                // Create level 2 popup
                const level2Div = document.createElement('div');
                level2Div.id = 'level2Popup';
                level2Div.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
                    padding: 30px;
                    border: 4px solid #FF6B35;
                    border-radius: 20px;
                    text-align: center;
                    z-index: 10000;
                    font-family: 'Comic Sans MS', cursive, sans-serif;
                    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
                    color: #8B4513;
                `;
                
                level2Div.innerHTML = `
                    <h2 style="color: #8B4513; margin-bottom: 20px;">🎉 LEVEL 2 UNLOCKED! 💰</h2>
                    <p style="color: #654321; font-size: 18px; margin-bottom: 20px;">
                        Wow! You caught 20 bananas! Now it's time to catch some money! 💵
                    </p>
                    <p style="color: #654321; font-size: 16px; margin-bottom: 30px;">
                        Catch 25 dollar bills to complete the game and see the special ending!
                    </p>
                    <button id="startLevel2Btn" style="
                        background: #4CAF50;
                        color: white;
                        border: none;
                        padding: 15px 30px;
                        border-radius: 10px;
                        font-size: 18px;
                        cursor: pointer;
                        font-family: inherit;
                        font-weight: bold;
                        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                    ">Start Level 2! 💰</button>
                `;
                
                document.body.appendChild(level2Div);
                
                // Add event listener
                document.getElementById('startLevel2Btn').addEventListener('click', () => {
                    document.body.removeChild(level2Div);
                    this.gameRunning = true;
                    this.gameMode = 'catching';
                });
            }
            
            startCashAppEnding() {
                this.gameRunning = false;
                this.gameMode = 'cashapp';
                this.animationTime = 0;
                this.cashAppPhase = 0; // 0: show message, 1: monkey winks, 2: show "The End"
                
                // Clear all falling objects
                this.bananas = [];
                this.dollarBills = [];
                
                // Initialize money falling animation for level 2 ending
                this.fallingMoney = [];
                
                // Position monkey in center for the ending
                this.monkey.x = 350;
                this.monkey.y = 250;
            }
            
            updateCashAppSequence() {
                this.animationTime += 1;
                
                // Spawn falling money throughout all phases
                this.spawnFallingMoney();
                this.updateFallingMoney();
                
                switch (this.cashAppPhase) {
                    case 0: // Show bitcoin message on screen - stays visible throughout
                        // Keep the message on screen during all phases
                        break;
                        
                    case 1: // Monkey winks while message is still visible
                        if (this.animationTime > 90) { // 1.5 seconds
                            this.cashAppPhase = 2;
                            this.animationTime = 0;
                        }
                        break;
                        
                    case 2: // Show "The End" text while message is still visible
                        // Keep showing "The End" text
                        break;
                }
            }
            
            spawnFallingMoney() {
                // Create falling money effect for level 2 ending
                if (Math.random() < 0.15) { // 15% chance each frame
                    this.fallingMoney.push({
                        x: Math.random() * this.canvas.width,
                        y: -40,
                        width: 40,
                        height: 25,
                        speed: 2 + Math.random() * 4, // Faster falling
                        rotation: Math.random() * Math.PI * 2,
                        rotationSpeed: (Math.random() - 0.5) * 0.1
                    });
                }
            }
            
            updateFallingMoney() {
                // Update falling money animation - falls all the way to bottom and beyond
                for (let i = this.fallingMoney.length - 1; i >= 0; i--) {
                    const money = this.fallingMoney[i];
                    money.y += money.speed;
                    money.rotation += money.rotationSpeed;
                    
                    // Remove if completely off screen (way below bottom of canvas)
                    if (money.y > this.canvas.height + 200) {
                        this.fallingMoney.splice(i, 1);
                    }
                }
            }
            
            drawFallingMoney() {
                // Draw falling money animation
                this.fallingMoney.forEach(money => {
                    this.ctx.save();
                    this.ctx.translate(money.x + money.width/2, money.y + money.height/2);
                    this.ctx.rotate(money.rotation);
                    
                    // Dollar bill main body (same as game dollars but bigger)
                    this.ctx.fillStyle = '#85BB65'; // Dollar bill green
                    this.ctx.strokeStyle = '#228B22';
                    this.ctx.lineWidth = 2;
                    this.ctx.beginPath();
                    this.ctx.roundRect(-money.width/2, -money.height/2, money.width, money.height, 3);
                    this.ctx.fill();
                    this.ctx.stroke();
                    
                    // Inner border
                    this.ctx.strokeStyle = '#006400';
                    this.ctx.lineWidth = 1.5;
                    this.ctx.beginPath();
                    this.ctx.roundRect(-money.width/2 + 2, -money.height/2 + 2, money.width - 4, money.height - 4, 2);
                    this.ctx.stroke();
                    
                    // Large dollar sign
                    this.ctx.fillStyle = '#006400';
                    this.ctx.strokeStyle = '#003300';
                    this.ctx.lineWidth = 1;
                    this.ctx.font = 'bold 24px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.textBaseline = 'middle';
                    this.ctx.strokeText('$', 0, 0);
                    this.ctx.fillText('$', 0, 0);
                    
                    // Corner dollar signs
                    this.ctx.fillStyle = '#006400';
                    this.ctx.font = 'bold 10px Arial';
                    this.ctx.fillText('$', -money.width/2 + 8, -money.height/2 + 6);
                    this.ctx.fillText('$', money.width/2 - 8, -money.height/2 + 6);
                    this.ctx.fillText('$', -money.width/2 + 8, money.height/2 - 6);
                    this.ctx.fillText('$', money.width/2 - 8, money.height/2 - 6);
                    
                    this.ctx.restore();
                });
            }
            
            drawCashAppSequence() {
                // Draw falling money animation first (behind everything)
                this.drawFallingMoney();
                
                // Draw the monkey (bigger for ending)
                this.drawEndingMonkey();
                
                // Always draw bitcoin message on screen throughout all phases
                this.drawBitcoinMessage();
                
                // Also draw "The End" text during phase 2
                if (this.cashAppPhase === 2) {
                    this.drawTheEndText();
                }
            }
            
            drawBitcoinMessage() {
                // Draw speech bubble positioned to the SIDE of monkey (floating beside, not from mouth)
                this.ctx.save();
                
                const bubbleWidth = 240; // Smaller than before (was 360)
                const bubbleHeight = 100; // Smaller than before (was 140)
                const bubbleX = this.monkey.x + 200; // Position to the RIGHT of monkey
                const bubbleY = this.monkey.y + 60; // Position at monkey's body level, not head
                
                // Make sure bubble stays on screen
                const minX = 10;
                const maxX = this.canvas.width - bubbleWidth - 10;
                const adjustedBubbleX = Math.max(minX, Math.min(bubbleX, maxX));
                
                // Draw speech bubble background (floating style, no tail pointing to mouth)
                this.ctx.fillStyle = 'white';
                this.ctx.strokeStyle = '#8B4513';
                this.ctx.lineWidth = 3;
                this.ctx.beginPath();
                this.ctx.roundRect(adjustedBubbleX, bubbleY, bubbleWidth, bubbleHeight, 12);
                this.ctx.fill();
                this.ctx.stroke();
                
                // Add a subtle shadow for floating effect
                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
                this.ctx.beginPath();
                this.ctx.roundRect(adjustedBubbleX + 3, bubbleY + 3, bubbleWidth, bubbleHeight, 12);
                this.ctx.fill();
                
                // Text inside speech bubble - LARGER TEXT
                this.ctx.fillStyle = '#8B4513';
                this.ctx.font = 'bold 16px Comic Sans MS, cursive'; // Bigger font
                this.ctx.textAlign = 'center';
                this.ctx.textBaseline = 'middle';
                
                // Multi-line text in bubble
                this.ctx.fillText('🎉 CONGRATULATIONS! 🎉', adjustedBubbleX + bubbleWidth/2, bubbleY + 15);
                this.ctx.font = 'bold 14px Comic Sans MS, cursive'; // Bigger font
                this.ctx.fillText(`You collected $${this.totalMoney}! 💰`, adjustedBubbleX + bubbleWidth/2, bubbleY + 32);
                this.ctx.font = 'bold 12px Comic Sans MS, cursive'; // Bigger font
                this.ctx.fillText('Put this money in Cash App', adjustedBubbleX + bubbleWidth/2, bubbleY + 50);
                this.ctx.fillText('and buy Bitcoin! 🚀', adjustedBubbleX + bubbleWidth/2, bubbleY + 68);
                
                this.ctx.restore();
            }
            
            drawEndingMonkey() {
                // Position monkey to the left of the giant banana for better visibility
                const monkey = { x: 200, y: 400 };
                const danceOffset = Math.sin(this.animationTime * 0.2) * 15;
                const armWave = Math.sin(this.animationTime * 0.3) * 25;
                const legBounce = Math.abs(Math.sin(this.animationTime * 0.4)) * 10;
                
                // Draw tail first (behind everything) - MOVES WITH BODY and stays connected
                this.drawMonkeyTail(monkey.x + danceOffset, monkey.y);
                
                // Big ears (draw first so they're behind the head) - ATTACHED to head with danceOffset
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 15 + danceOffset, monkey.y + 30, 18, 0, Math.PI * 2); // Left ear - moves with head
                this.ctx.arc(monkey.x + 85 + danceOffset, monkey.y + 30, 18, 0, Math.PI * 2); // Right ear - moves with head
                this.ctx.fill();
                
                // Inner ears (pink) - ATTACHED to head with danceOffset
                this.ctx.fillStyle = '#FFB6C1';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 15 + danceOffset, monkey.y + 30, 12, 0, Math.PI * 2); // Left inner ear - moves with head
                this.ctx.arc(monkey.x + 85 + danceOffset, monkey.y + 30, 12, 0, Math.PI * 2); // Right inner ear - moves with head
                this.ctx.fill();
                
                // Body (swaying with dance)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50 + danceOffset, monkey.y + 70, 35, 45, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Chest (lighter color)
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50 + danceOffset, monkey.y + 75, 20, 30, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Head (swaying with joy)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 50 + danceOffset, monkey.y + 35, 30, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Muzzle
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50 + danceOffset, monkey.y + 45, 15, 12, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Nostrils
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 47 + danceOffset, monkey.y + 42, 1.5, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 53 + danceOffset, monkey.y + 42, 1.5, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eyes (happy and excited)
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 42 + danceOffset, monkey.y + 30, 8, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 58 + danceOffset, monkey.y + 30, 8, 0, Math.PI * 2);
                this.ctx.fill();
                
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 43 + danceOffset, monkey.y + 30, 4, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 57 + danceOffset, monkey.y + 30, 4, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eye highlights (sparkling with joy)
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 44 + danceOffset, monkey.y + 29, 2, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 58 + danceOffset, monkey.y + 29, 2, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Big happy smile
                this.ctx.strokeStyle = 'black';
                this.ctx.lineWidth = 3;
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 50 + danceOffset, monkey.y + 48, 12, 0, Math.PI);
                this.ctx.stroke();
                
                // Dancing arms (left arm holding phone, right arm celebrating)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 8;
                
                // Left arm (holding phone up in celebration - waving) - starts from body
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 20 + danceOffset, monkey.y + 60);
                this.ctx.quadraticCurveTo(monkey.x + 5 + danceOffset + armWave, monkey.y + 40, monkey.x + 10 + danceOffset + armWave, monkey.y + 20);
                this.ctx.stroke();
                
                // Right arm (also celebrating - waving up) - starts from body
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 80 + danceOffset, monkey.y + 60);
                this.ctx.quadraticCurveTo(monkey.x + 95 + danceOffset - armWave, monkey.y + 40, monkey.x + 90 + danceOffset - armWave, monkey.y + 20);
                this.ctx.stroke();
                
                // Left hand holding phone (moves with arm wave and body)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 10 + danceOffset + armWave, monkey.y + 20, 10, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Phone in left hand (dancing with the monkey) - ONLY ONE PHONE, moves with body and arm
                this.drawPhoneWithCashApp(monkey.x + 5 + danceOffset + armWave, monkey.y + 15);
                
                // Right celebrating hand (moves with body and arm)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 90 + danceOffset - armWave, monkey.y + 20, 10, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Dancing legs (bouncing) - BACK TO ORIGINAL VICTORY DANCE LEGS
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 6;
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 35 + danceOffset, monkey.y + 110);
                this.ctx.lineTo(monkey.x + 30 + danceOffset, monkey.y + 135 + legBounce);
                this.ctx.moveTo(monkey.x + 65 + danceOffset, monkey.y + 110);
                this.ctx.lineTo(monkey.x + 70 + danceOffset, monkey.y + 135 + legBounce);
                this.ctx.stroke();
                
                // Dancing feet - BACK TO ORIGINAL VICTORY DANCE FEET
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 30 + danceOffset, monkey.y + 140 + legBounce, 15, 8, 0, 0, Math.PI * 2);
                this.ctx.ellipse(monkey.x + 70 + danceOffset, monkey.y + 140 + legBounce, 15, 8, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Draw party hat DIRECTLY on top of monkey's head - STAYS ON HEAD during dance
                this.drawPartyHat(monkey.x + 50 + danceOffset, monkey.y + 5); // Hat positioned directly on top of dancing head
            }
            
            startWinkAnimation() {
                this.gameMode = 'winking';
                this.animationTime = 0;
                this.winkPhase = 0; // 0: normal, 1: winking, 2: normal, 3: show "The End"
                
                // Position monkey in center for the wink
                this.monkey.x = 350;
                this.monkey.y = 250;
            }
            
            updateWinkSequence() {
                this.animationTime += 1;
                
                switch (this.winkPhase) {
                    case 0: // Normal expression for a moment
                        if (this.animationTime > 60) { // 1 second
                            this.winkPhase = 1;
                            this.animationTime = 0;
                        }
                        break;
                        
                    case 1: // Winking
                        if (this.animationTime > 90) { // 1.5 seconds
                            this.winkPhase = 2;
                            this.animationTime = 0;
                        }
                        break;
                        
                    case 2: // Back to normal
                        if (this.animationTime > 60) { // 1 second
                            this.winkPhase = 3;
                            this.animationTime = 0;
                        }
                        break;
                        
                    case 3: // Show "The End"
                        // Keep showing "The End" text
                        break;
                }
            }
            
            drawWinkingMonkey() {
                const monkey = this.monkey;
                const scale = 2; // Make monkey bigger for the ending
                
                // Draw tail first (behind everything) - scaled position
                this.drawMonkeyTail(monkey.x, monkey.y);
                
                // Save context and scale up
                this.ctx.save();
                this.ctx.translate(monkey.x + 50, monkey.y + 60);
                this.ctx.scale(scale, scale);
                this.ctx.translate(-50, -60);
                
                // Big ears (draw first so they're behind the head)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(15, 30, 18, 0, Math.PI * 2); // Left ear
                this.ctx.arc(85, 30, 18, 0, Math.PI * 2); // Right ear
                this.ctx.fill();
                
                // Inner ears (pink)
                this.ctx.fillStyle = '#FFB6C1';
                this.ctx.beginPath();
                this.ctx.arc(15, 30, 12, 0, Math.PI * 2); // Left inner ear
                this.ctx.arc(85, 30, 12, 0, Math.PI * 2); // Right inner ear
                this.ctx.fill();
                
                // Body (more monkey-like)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.beginPath();
                this.ctx.ellipse(50, 70, 35, 45, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Chest (lighter color)
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(50, 75, 20, 30, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Head (larger and more rounded)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(50, 35, 30, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Muzzle
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(50, 45, 15, 12, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Nostrils
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(47, 42, 1.5, 0, Math.PI * 2);
                this.ctx.arc(53, 42, 1.5, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eyes - special winking animation
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(42, 30, 6, 0, Math.PI * 2); // Left eye (always open)
                if (this.winkPhase !== 1) {
                    this.ctx.arc(58, 30, 6, 0, Math.PI * 2); // Right eye (winks)
                }
                this.ctx.fill();
                
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(43, 30, 3, 0, Math.PI * 2); // Left pupil
                if (this.winkPhase !== 1) {
                    this.ctx.arc(57, 30, 3, 0, Math.PI * 2); // Right pupil (winks)
                }
                this.ctx.fill();
                
                // Eye highlights
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(44, 29, 1, 0, Math.PI * 2); // Left highlight
                if (this.winkPhase !== 1) {
                    this.ctx.arc(58, 29, 1, 0, Math.PI * 2); // Right highlight (winks)
                }
                this.ctx.fill();
                
                // Winking eye (curved line when closed)
                if (this.winkPhase === 1) {
                    this.ctx.strokeStyle = 'black';
                    this.ctx.lineWidth = 3;
                    this.ctx.beginPath();
                    this.ctx.arc(58, 30, 6, 0.2, Math.PI - 0.2);
                    this.ctx.stroke();
                }
                
                // Big happy smile
                this.ctx.strokeStyle = 'black';
                this.ctx.lineWidth = 3;
                this.ctx.beginPath();
                this.ctx.arc(50, 48, 12, 0, Math.PI);
                this.ctx.stroke();
                
                // Arms (relaxed position)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 8;
                
                // Left arm
                this.ctx.beginPath();
                this.ctx.moveTo(20, 60);
                this.ctx.lineTo(10, 90);
                this.ctx.stroke();
                
                // Right arm  
                this.ctx.beginPath();
                this.ctx.moveTo(80, 60);
                this.ctx.lineTo(90, 90);
                this.ctx.stroke();
                
                // Hands
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(10, 90, 8, 0, Math.PI * 2);
                this.ctx.arc(90, 90, 8, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Legs
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 6;
                this.ctx.beginPath();
                this.ctx.moveTo(35, 110);
                this.ctx.lineTo(30, 140);
                this.ctx.moveTo(65, 110);
                this.ctx.lineTo(70, 140);
                this.ctx.stroke();
                
                // Feet
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.ellipse(30, 145, 12, 6, 0, 0, Math.PI * 2);
                this.ctx.ellipse(70, 145, 12, 6, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                this.ctx.restore();
            }
            
            drawTheEndText() {
                if (this.winkPhase === 3) {
                    // Simple, non-flashing "The End" text positioned under the monkey
                    this.ctx.save();
                    this.ctx.fillStyle = '#8B4513';
                    this.ctx.strokeStyle = '#654321';
                    this.ctx.lineWidth = 2;
                    this.ctx.font = 'bold 32px Comic Sans MS, cursive'; // Smaller, not huge
                    this.ctx.textAlign = 'center';
                    this.ctx.textBaseline = 'middle';
                    
                    // Position text under the monkey (not flashing)
                    const textY = this.monkey.y + 200; // Below the monkey
                    
                    // Draw text with outline (no animation)
                    this.ctx.strokeText('The End', this.canvas.width / 2, textY);
                    this.ctx.fillText('The End', this.canvas.width / 2, textY);
                    
                    this.ctx.restore();
                }
            }
            
            startVictorySequence() {
                this.gameMode = 'victory';
                this.victoryPhase = 0; // Start with walking
                this.animationTime = 0;
                this.monkey.x = 50; // Start from left side
                this.monkey.y = 450; // Put monkey on ground
                this.bananas = []; // Clear all bananas
            }
            
            handleTreeJump() {
                // Handle spacebar jumping between trees during swinging phases
                if (this.victoryPhase === 2) {
                    // Jump from first tree to second tree
                    this.victoryPhase = 3;
                    this.animationTime = 0;
                    this.createParticles(this.monkey.x + 50, this.monkey.y + 50, '#90EE90'); // Green particles for jump
                } else if (this.victoryPhase === 3) {
                    // Jump from second tree to third tree (with giant banana)
                    this.victoryPhase = 4;
                    this.animationTime = 0;
                    this.createParticles(this.monkey.x + 50, this.monkey.y + 50, '#FFD700'); // Gold particles for final jump
                }
            }
            
            gameOver() {
                this.gameRunning = false;
                this.startButton.textContent = `Game Over! Score: ${this.score} - Play Again?`;
                this.startButton.style.display = 'block';
            }
            
            updateUI() {
                document.getElementById('score').textContent = this.score;
                document.getElementById('lives').textContent = this.lives;
                document.getElementById('level').textContent = this.level;
            }
            
            updateVictorySequence() {
                this.animationTime += 1;
                
                switch (this.victoryPhase) {
                    case 0: // Walking to the right to reach trees
                        this.monkey.x += 3;
                        // Walking animation - slight bounce
                        this.monkey.y = 450 + Math.sin(this.animationTime * 0.2) * 5;
                        if (this.monkey.x > 130) { // Near first tree
                            this.victoryPhase = 1;
                            this.animationTime = 0;
                        }
                        break;
                        
                    case 1: // Running and jumping to first tree
                        this.monkey.x += 2;
                        this.monkey.y -= 3; // Jump up to tree
                        if (this.animationTime > 40) { // Reached first tree
                            this.monkey.x = 167; // Position at first tree
                            this.monkey.y = 280; // In the tree
                            this.victoryPhase = 2;
                            this.animationTime = 0;
                        }
                        break;
                        
                    case 2: // Swinging with arms from tree 1 to tree 2
                        // Swinging motion from tree 1 to tree 2 - arms extended
                        const progress2 = this.animationTime / 60;
                        this.monkey.x = 167 + (370 - 167) * progress2; // From tree 1 to tree 2
                        this.monkey.y = 280 - Math.sin(progress2 * Math.PI) * 40; // Swinging arc
                        
                        // Draw swinging arms during this phase
                        this.drawSwingingArms(progress2, 167, 370);
                        
                        if (this.animationTime > 60) {
                            this.monkey.x = 370; // Position at second tree
                            this.monkey.y = 260; // In the tree
                            this.victoryPhase = 3;
                            this.animationTime = 0;
                        }
                        break;
                        
                    case 3: // Swinging with arms from tree 2 to tree 3 (giant banana tree)
                        // Swinging motion from tree 2 to tree 3
                        const progress3 = this.animationTime / 80;
                        this.monkey.x = 370 + (602 - 370) * progress3; // From tree 2 to tree 3
                        this.monkey.y = 260 - Math.sin(progress3 * Math.PI) * 50; // Higher swinging arc
                        
                        // Draw swinging arms during this phase
                        this.drawSwingingArms(progress3, 370, 602);
                        
                        if (this.animationTime > 80) {
                            this.monkey.x = 602; // Position at third tree
                            this.monkey.y = 240; // In the tree with banana
                            this.victoryPhase = 4;
                            this.animationTime = 0;
                        }
                        break;
                        
                    case 4: // Falling down with banana and celebrating
                        if (this.animationTime < 60) {
                            // Falling down with banana
                            this.monkey.y += 4; // Fall down
                            if (this.monkey.y > 400) {
                                this.monkey.y = 400; // Land on ground
                            }
                        } else {
                            // Start raining bananas after landing
                            this.spawnRainingBananas();
                        }
                        break;
                }
            }
            
            spawnRainingBananas() {
                // Create raining bananas effect
                if (Math.random() < 0.3) { // 30% chance each frame
                    this.bananas.push({
                        x: Math.random() * this.canvas.width,
                        y: -40,
                        width: 30,
                        height: 30,
                        speed: 2 + Math.random() * 3,
                        rotation: Math.random() * Math.PI * 2
                    });
                }
            }
            
            spawnDollarRain() {
                // No small dollar rain - user prefers only big green dollar bills
                // This function is kept for compatibility but does nothing
            }
            
            updateDollarRain() {
                // Update continuous dollar rain animation
                for (let i = this.dollarRain.length - 1; i >= 0; i--) {
                    const dollar = this.dollarRain[i];
                    dollar.y += dollar.speed;
                    dollar.rotation += dollar.rotationSpeed;
                    dollar.life--;
                    
                    // Remove if off screen or life expired
                    if (dollar.y > this.canvas.height + 50 || dollar.life <= 0) {
                        this.dollarRain.splice(i, 1);
                    }
                }
            }
            
            drawDollarRain() {
                // Draw continuous dollar rain animation
                this.dollarRain.forEach(dollar => {
                    this.ctx.save();
                    this.ctx.globalAlpha = dollar.opacity;
                    this.ctx.translate(dollar.x + dollar.width/2, dollar.y + dollar.height/2);
                    this.ctx.rotate(dollar.rotation);
                    
                    // Dollar bill main body (smaller than game dollars)
                    this.ctx.fillStyle = '#85BB65'; // Dollar bill green
                    this.ctx.strokeStyle = '#228B22';
                    this.ctx.lineWidth = 1;
                    this.ctx.beginPath();
                    this.ctx.roundRect(-dollar.width/2, -dollar.height/2, dollar.width, dollar.height, 2);
                    this.ctx.fill();
                    this.ctx.stroke();
                    
                    // Dollar sign
                    this.ctx.fillStyle = '#006400';
                    this.ctx.font = 'bold 8px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.textBaseline = 'middle';
                    this.ctx.fillText('$', 0, 0);
                    
                    this.ctx.restore();
                });
            }
            
            drawVictorySequence() {
                // Draw trees
                this.drawTrees();
                
                // Draw raining bananas during victory dance (phase 4)
                if (this.victoryPhase === 4) {
                    this.drawBananas(); // Draw the raining bananas
                }
                
                // Draw monkey in victory sequence
                if (this.victoryPhase === 4) {
                    this.drawDancingMonkey();
                    this.drawGiantBanana();
                } else {
                    this.drawVictoryMonkey();
                }
            }
            
            drawTrees() {
                // Tree 1 - Banana tree with bananas hanging by leaves
                this.ctx.fillStyle = '#654321';
                this.ctx.fillRect(150, 320, 35, 230);
                // Tree bark texture
                this.ctx.strokeStyle = '#4A4A4A';
                this.ctx.lineWidth = 2;
                for (let i = 0; i < 8; i++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(150, 330 + i * 25);
                    this.ctx.lineTo(185, 335 + i * 25);
                    this.ctx.stroke();
                }
                
                // Banana tree leaves (large palm-like leaves)
                this.ctx.fillStyle = '#228B22';
                this.ctx.strokeStyle = '#1F5F1F';
                this.ctx.lineWidth = 3;
                
                // Draw banana leaves radiating from center - MUCH LARGER
                for (let i = 0; i < 12; i++) {
                    const angle = (i / 12) * Math.PI * 2;
                    const leafLength = 120; // Much larger leaves
                    const leafWidth = 30; // Much wider leaves
                    
                    this.ctx.save();
                    this.ctx.translate(167, 320);
                    this.ctx.rotate(angle);
                    
                    // Leaf shape
                    this.ctx.beginPath();
                    this.ctx.ellipse(leafLength/2, 0, leafLength/2, leafWidth/2, 0, 0, Math.PI * 2);
                    this.ctx.fill();
                    this.ctx.stroke();
                    
                    this.ctx.restore();
                }
                
                // Bananas hanging by leaves from tree 1 - BIGGER
                this.drawHangingBananas(167, 300, 4, 2.5);
                
                // Tree 2 - Middle banana tree with bananas hanging by leaves
                this.ctx.fillStyle = '#654321';
                this.ctx.fillRect(350, 300, 40, 250);
                // Tree bark texture
                for (let i = 0; i < 9; i++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(350, 310 + i * 25);
                    this.ctx.lineTo(390, 315 + i * 25);
                    this.ctx.stroke();
                }
                
                // Banana tree leaves for tree 2
                this.ctx.fillStyle = '#228B22';
                for (let i = 0; i < 8; i++) {
                    const angle = (i / 8) * Math.PI * 2;
                    const leafLength = 65;
                    const leafWidth = 18;
                    
                    this.ctx.save();
                    this.ctx.translate(370, 300);
                    this.ctx.rotate(angle);
                    
                    // Leaf shape
                    this.ctx.beginPath();
                    this.ctx.ellipse(leafLength/2, 0, leafLength/2, leafWidth/2, 0, 0, Math.PI * 2);
                    this.ctx.fill();
                    this.ctx.stroke();
                    
                    this.ctx.restore();
                }
                
                // Bananas hanging by leaves from tree 2 - BIGGER
                this.drawHangingBananas(370, 280, 5, 2.8);
                
                // Tree 3 - Final banana tree (with GIANT bananas)
                this.ctx.fillStyle = '#654321';
                this.ctx.fillRect(580, 280, 45, 270);
                // Tree bark texture
                for (let i = 0; i < 10; i++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(580, 290 + i * 25);
                    this.ctx.lineTo(625, 295 + i * 25);
                    this.ctx.stroke();
                }
                
                // Banana tree leaves for tree 3 (biggest)
                this.ctx.fillStyle = '#228B22';
                for (let i = 0; i < 10; i++) {
                    const angle = (i / 10) * Math.PI * 2;
                    const leafLength = 70;
                    const leafWidth = 20;
                    
                    this.ctx.save();
                    this.ctx.translate(602, 280);
                    this.ctx.rotate(angle);
                    
                    // Leaf shape
                    this.ctx.beginPath();
                    this.ctx.ellipse(leafLength/2, 0, leafLength/2, leafWidth/2, 0, 0, Math.PI * 2);
                    this.ctx.fill();
                    this.ctx.stroke();
                    
                    this.ctx.restore();
                }
                
                // GIANT bananas hanging from tree 3 (much bigger!) - ALWAYS VISIBLE
                this.drawHangingBananas(602, 260, 3, 3.5); // GIANT bananas!
            }
            
            drawHangingBananas(x, y, count, scale) {
                // Draw bananas hanging by leaves from the tree
                for (let i = 0; i < count; i++) {
                    const bananaX = x + (i - count/2) * (15 * scale);
                    const bananaY = y + 20 + i * (5 * scale);
                    const swayOffset = Math.sin(Date.now() * 0.003 + i) * (3 * scale);
                    
                    // Draw leaf stem connecting banana to tree
                    this.ctx.strokeStyle = '#228B22';
                    this.ctx.lineWidth = 2 * scale;
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, y);
                    this.ctx.quadraticCurveTo(x + swayOffset, y + 10 * scale, bananaX + swayOffset, bananaY - 5 * scale);
                    this.ctx.stroke();
                    
                    // Draw small leaf at connection point
                    this.ctx.fillStyle = '#32CD32';
                    this.ctx.save();
                    this.ctx.translate(bananaX + swayOffset, bananaY - 5 * scale);
                    this.ctx.scale(scale * 0.8, scale * 0.8);
                    this.ctx.beginPath();
                    this.ctx.ellipse(0, -3, 8, 3, Math.PI * 0.1, 0, Math.PI * 2);
                    this.ctx.fill();
                    this.ctx.restore();
                    
                    // Draw banana hanging from leaf
                    this.ctx.save();
                    this.ctx.translate(bananaX + swayOffset, bananaY);
                    this.ctx.scale(scale, scale);
                    
                    // Banana main body
                    this.ctx.fillStyle = '#FFD700';
                    this.ctx.beginPath();
                    this.ctx.moveTo(-8, -2);
                    this.ctx.quadraticCurveTo(-5, -4, 0, -3);
                    this.ctx.quadraticCurveTo(5, -1, 8, 2);
                    this.ctx.quadraticCurveTo(5, 4, 0, 3);
                    this.ctx.quadraticCurveTo(-5, 1, -8, -2);
                    this.ctx.fill();
                    
                    // Banana highlights
                    this.ctx.fillStyle = '#FFFF99';
                    this.ctx.beginPath();
                    this.ctx.moveTo(-6, -1);
                    this.ctx.quadraticCurveTo(-3, -2, 1, -1);
                    this.ctx.quadraticCurveTo(4, 0, 6, 1);
                    this.ctx.quadraticCurveTo(4, 2, 1, 1);
                    this.ctx.quadraticCurveTo(-3, 0, -6, -1);
                    this.ctx.fill();
                    
                    // Banana ridges
                    this.ctx.strokeStyle = '#E6C200';
                    this.ctx.lineWidth = 0.5;
                    for (let j = -1; j <= 1; j++) {
                        this.ctx.beginPath();
                        this.ctx.moveTo(-8, j);
                        this.ctx.quadraticCurveTo(0, j - 1, 8, j + 0.5);
                        this.ctx.stroke();
                    }
                    
                    // Banana stem
                    this.ctx.fillStyle = '#8B4513';
                    this.ctx.beginPath();
                    this.ctx.arc(-8, -1, 1.5, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    // Banana tip
                    this.ctx.fillStyle = '#654321';
                    this.ctx.beginPath();
                    this.ctx.arc(8, 1, 1, 0, Math.PI * 2);
                    this.ctx.fill();
                    
                    this.ctx.restore();
                }
            }
            
            drawSwingingArms(progress, startTreeX, endTreeX) {
                // Draw realistic arm swinging - one arm stays on tree while other reaches
                const monkey = this.monkey;
                
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 10;
                
                if (progress < 0.5) {
                    // First half: Left arm stays on start tree, right arm reaches for end tree
                    
                    // Left arm holding current tree (stays put)
                    this.ctx.beginPath();
                    this.ctx.moveTo(monkey.x + 20, monkey.y + 60);
                    this.ctx.quadraticCurveTo(monkey.x - 10, monkey.y + 40, startTreeX, monkey.y - 20);
                    this.ctx.stroke();
                    
                    // Right arm reaching for next tree
                    const reachProgress = progress * 2; // 0 to 1 for first half
                    const reachX = monkey.x + 80 + (endTreeX - (monkey.x + 80)) * reachProgress;
                    const reachY = monkey.y + 60 - Math.sin(reachProgress * Math.PI) * 40;
                    
                    this.ctx.beginPath();
                    this.ctx.moveTo(monkey.x + 80, monkey.y + 60);
                    this.ctx.quadraticCurveTo(reachX - 20, reachY, endTreeX, monkey.y - 20);
                    this.ctx.stroke();
                    
                    // Draw hands
                    this.ctx.fillStyle = '#CD853F';
                    this.ctx.beginPath();
                    this.ctx.arc(startTreeX, monkey.y - 20, 10, 0, Math.PI * 2); // Left hand on start tree
                    this.ctx.arc(endTreeX, monkey.y - 20, 10, 0, Math.PI * 2); // Right hand reaching end tree
                    this.ctx.fill();
                    
                } else {
                    // Second half: Right arm holds end tree, left arm releases and swings
                    
                    // Right arm holding end tree (stays put)
                    this.ctx.beginPath();
                    this.ctx.moveTo(monkey.x + 80, monkey.y + 60);
                    this.ctx.quadraticCurveTo(monkey.x + 110, monkey.y + 40, endTreeX, monkey.y - 20);
                    this.ctx.stroke();
                    
                    // Left arm swinging free (releasing from start tree)
                    const swingProgress = (progress - 0.5) * 2; // 0 to 1 for second half
                    const swingX = monkey.x + 20 - Math.sin(swingProgress * Math.PI) * 30;
                    const swingY = monkey.y + 60 + Math.sin(swingProgress * Math.PI) * 20;
                    
                    this.ctx.beginPath();
                    this.ctx.moveTo(monkey.x + 20, monkey.y + 60);
                    this.ctx.quadraticCurveTo(swingX, swingY, monkey.x - 20, monkey.y + 80);
                    this.ctx.stroke();
                    
                    // Draw hands
                    this.ctx.fillStyle = '#CD853F';
                    this.ctx.beginPath();
                    this.ctx.arc(endTreeX, monkey.y - 20, 10, 0, Math.PI * 2); // Right hand on end tree
                    this.ctx.arc(monkey.x - 20, monkey.y + 80, 8, 0, Math.PI * 2); // Left hand swinging free
                    this.ctx.fill();
                }
            }
            
            drawTreeBanana(x, y, scale) {
                // Draw giant banana hanging from tree
                this.ctx.save();
                this.ctx.translate(x, y);
                this.ctx.scale(scale, scale);
                
                // Banana main body
                this.ctx.fillStyle = '#FFD700';
                this.ctx.beginPath();
                this.ctx.moveTo(-15, -3);
                this.ctx.quadraticCurveTo(-10, -8, 0, -5);
                this.ctx.quadraticCurveTo(10, -2, 15, 3);
                this.ctx.quadraticCurveTo(10, 8, 0, 5);
                this.ctx.quadraticCurveTo(-10, 2, -15, -3);
                this.ctx.fill();
                
                // Banana highlights
                this.ctx.fillStyle = '#FFFF99';
                this.ctx.beginPath();
                this.ctx.moveTo(-12, -1);
                this.ctx.quadraticCurveTo(-8, -4, 2, -2);
                this.ctx.quadraticCurveTo(8, 0, 12, 1);
                this.ctx.quadraticCurveTo(8, 3, 2, 2);
                this.ctx.quadraticCurveTo(-8, 0, -12, -1);
                this.ctx.fill();
                
                // Banana ridges
                this.ctx.strokeStyle = '#E6C200';
                this.ctx.lineWidth = 1;
                for (let i = -1; i <= 1; i++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(-15, i * 2);
                    this.ctx.quadraticCurveTo(0, i * 2 - 2, 15, i * 2 + 1);
                    this.ctx.stroke();
                }
                
                // Banana stem
                this.ctx.fillStyle = '#8B4513';
                this.ctx.beginPath();
                this.ctx.arc(-15, -1, 3, 0, Math.PI * 2);
                this.ctx.fill();
                
                this.ctx.restore();
                
                // Stem connecting to tree
                this.ctx.strokeStyle = '#8B4513';
                this.ctx.lineWidth = 4;
                this.ctx.beginPath();
                this.ctx.moveTo(x, y - 20);
                this.ctx.lineTo(x, y);
                this.ctx.stroke();
            }
            
            drawVictoryMonkey() {
                // Use the same detailed monkey as the main game
                const monkey = this.monkey;
                
                // Draw tail first (behind everything)
                this.drawMonkeyTail(monkey.x, monkey.y);
                
                // Big ears (draw first so they're behind the head) - like the start monkey
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 15, monkey.y + 30, 18, 0, Math.PI * 2); // Left ear
                this.ctx.arc(monkey.x + 85, monkey.y + 30, 18, 0, Math.PI * 2); // Right ear
                this.ctx.fill();
                
                // Inner ears (pink) - like the start monkey
                this.ctx.fillStyle = '#FFB6C1';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 15, monkey.y + 30, 12, 0, Math.PI * 2); // Left inner ear
                this.ctx.arc(monkey.x + 85, monkey.y + 30, 12, 0, Math.PI * 2); // Right inner ear
                this.ctx.fill();
                
                // Body (more monkey-like)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50, monkey.y + 70, 35, 45, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Chest (lighter color)
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50, monkey.y + 75, 20, 30, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Head (larger and more rounded)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 50, monkey.y + 35, 30, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Muzzle
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50, monkey.y + 45, 15, 12, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Nostrils
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 47, monkey.y + 42, 1.5, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 53, monkey.y + 42, 1.5, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eyes (larger and more expressive)
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 42, monkey.y + 30, 6, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 58, monkey.y + 30, 6, 0, Math.PI * 2);
                this.ctx.fill();
                
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 43, monkey.y + 30, 3, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 57, monkey.y + 30, 3, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eye highlights
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 44, monkey.y + 29, 1, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 58, monkey.y + 29, 1, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Smile
                this.ctx.strokeStyle = 'black';
                this.ctx.lineWidth = 2;
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 50, monkey.y + 48, 8, 0, Math.PI);
                this.ctx.stroke();
                
                // Arms (for walking/climbing)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 8;
                
                // Left arm
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 20, monkey.y + 60);
                this.ctx.lineTo(monkey.x + 10, monkey.y + 90);
                this.ctx.stroke();
                
                // Right arm  
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 80, monkey.y + 60);
                this.ctx.lineTo(monkey.x + 90, monkey.y + 90);
                this.ctx.stroke();
                
                // Hands
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 10, monkey.y + 90, 8, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 90, monkey.y + 90, 8, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Legs
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 6;
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 35, monkey.y + 110);
                this.ctx.lineTo(monkey.x + 30, monkey.y + 140);
                this.ctx.moveTo(monkey.x + 65, monkey.y + 110);
                this.ctx.lineTo(monkey.x + 70, monkey.y + 140);
                this.ctx.stroke();
                
                // Feet
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 30, monkey.y + 145, 12, 6, 0, 0, Math.PI * 2);
                this.ctx.ellipse(monkey.x + 70, monkey.y + 145, 12, 6, 0, 0, Math.PI * 2);
                this.ctx.fill();
            }
            
            drawDancingMonkey() {
                // Position monkey to the left of the giant banana for better visibility
                const monkey = { x: 200, y: 400 };
                const danceOffset = Math.sin(this.animationTime * 0.2) * 15;
                const armWave = Math.sin(this.animationTime * 0.3) * 25;
                const legBounce = Math.abs(Math.sin(this.animationTime * 0.4)) * 10;
                
                // Draw tail first (behind everything) - MOVES WITH BODY and stays connected
                this.drawMonkeyTail(monkey.x + danceOffset, monkey.y);
                
                // Big ears (draw first so they're behind the head) - ATTACHED to head with danceOffset
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 15 + danceOffset, monkey.y + 30, 18, 0, Math.PI * 2); // Left ear - moves with head
                this.ctx.arc(monkey.x + 85 + danceOffset, monkey.y + 30, 18, 0, Math.PI * 2); // Right ear - moves with head
                this.ctx.fill();
                
                // Inner ears (pink) - ATTACHED to head with danceOffset
                this.ctx.fillStyle = '#FFB6C1';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 15 + danceOffset, monkey.y + 30, 12, 0, Math.PI * 2); // Left inner ear - moves with head
                this.ctx.arc(monkey.x + 85 + danceOffset, monkey.y + 30, 12, 0, Math.PI * 2); // Right inner ear - moves with head
                this.ctx.fill();
                
                // Body (swaying with dance)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50 + danceOffset, monkey.y + 70, 35, 45, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Chest (lighter color)
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50 + danceOffset, monkey.y + 75, 20, 30, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Head (swaying with joy)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 50 + danceOffset, monkey.y + 35, 30, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Muzzle
                this.ctx.fillStyle = '#DEB887';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 50 + danceOffset, monkey.y + 45, 15, 12, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Nostrils
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 47 + danceOffset, monkey.y + 42, 1.5, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 53 + danceOffset, monkey.y + 42, 1.5, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eyes (happy and excited)
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 42 + danceOffset, monkey.y + 30, 8, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 58 + danceOffset, monkey.y + 30, 8, 0, Math.PI * 2);
                this.ctx.fill();
                
                this.ctx.fillStyle = 'black';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 43 + danceOffset, monkey.y + 30, 4, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 57 + danceOffset, monkey.y + 30, 4, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Eye highlights (sparkling with joy)
                this.ctx.fillStyle = 'white';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 44 + danceOffset, monkey.y + 29, 2, 0, Math.PI * 2);
                this.ctx.arc(monkey.x + 58 + danceOffset, monkey.y + 29, 2, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Big happy smile
                this.ctx.strokeStyle = 'black';
                this.ctx.lineWidth = 3;
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 50 + danceOffset, monkey.y + 48, 12, 0, Math.PI);
                this.ctx.stroke();
                
                // Dancing arms (left arm holding phone, right arm celebrating)
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 8;
                
                // Left arm (holding phone up in celebration - waving) - starts from body
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 20 + danceOffset, monkey.y + 60);
                this.ctx.quadraticCurveTo(monkey.x + 5 + danceOffset + armWave, monkey.y + 40, monkey.x + 10 + danceOffset + armWave, monkey.y + 20);
                this.ctx.stroke();
                
                // Right arm (also celebrating - waving up) - starts from body
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 80 + danceOffset, monkey.y + 60);
                this.ctx.quadraticCurveTo(monkey.x + 95 + danceOffset - armWave, monkey.y + 40, monkey.x + 90 + danceOffset - armWave, monkey.y + 20);
                this.ctx.stroke();
                
                // Left hand holding phone (moves with arm wave and body)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 10 + danceOffset + armWave, monkey.y + 20, 10, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Phone in left hand (dancing with the monkey) - ONLY ONE PHONE, moves with body and arm
                this.drawPhoneWithCashApp(monkey.x + 5 + danceOffset + armWave, monkey.y + 15);
                
                // Right celebrating hand (moves with body and arm)
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.arc(monkey.x + 90 + danceOffset - armWave, monkey.y + 20, 10, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Dancing legs (bouncing) - BACK TO ORIGINAL VICTORY DANCE LEGS
                this.ctx.fillStyle = '#8B4513';
                this.ctx.strokeStyle = '#654321';
                this.ctx.lineWidth = 6;
                this.ctx.beginPath();
                this.ctx.moveTo(monkey.x + 35 + danceOffset, monkey.y + 110);
                this.ctx.lineTo(monkey.x + 30 + danceOffset, monkey.y + 135 + legBounce);
                this.ctx.moveTo(monkey.x + 65 + danceOffset, monkey.y + 110);
                this.ctx.lineTo(monkey.x + 70 + danceOffset, monkey.y + 135 + legBounce);
                this.ctx.stroke();
                
                // Dancing feet - BACK TO ORIGINAL VICTORY DANCE FEET
                this.ctx.fillStyle = '#CD853F';
                this.ctx.beginPath();
                this.ctx.ellipse(monkey.x + 30 + danceOffset, monkey.y + 140 + legBounce, 15, 8, 0, 0, Math.PI * 2);
                this.ctx.ellipse(monkey.x + 70 + danceOffset, monkey.y + 140 + legBounce, 15, 8, 0, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Draw party hat DIRECTLY on top of monkey's head - STAYS ON HEAD during dance
                this.drawPartyHat(monkey.x + 50 + danceOffset, monkey.y + 5); // Hat positioned directly on top of dancing head
            }
            
            drawGiantBanana() {
                // Draw giant banana on the ground next to the monkey
                const bananaX = 450; // To the right of the monkey
                const bananaY = 480; // On the ground
                const bounceOffset = Math.sin(this.animationTime * 0.15) * 5;
                const sparkleTime = this.animationTime * 0.2;
                
                // Giant banana on the ground
                this.ctx.save();
                this.ctx.translate(bananaX, bananaY + bounceOffset);
                this.ctx.scale(5, 5); // Make it HUGE!
                
                // Banana main body with more detailed curved shape
                this.ctx.fillStyle = '#FFD700';
                this.ctx.beginPath();
                this.ctx.moveTo(-20, -5);
                this.ctx.quadraticCurveTo(-15, -12, 0, -8);
                this.ctx.quadraticCurveTo(15, -4, 20, 5);
                this.ctx.quadraticCurveTo(15, 12, 0, 8);
                this.ctx.quadraticCurveTo(-15, 4, -20, -5);
                this.ctx.fill();
                
                // Banana highlights (to make it look 3D and shiny)
                this.ctx.fillStyle = '#FFFF99';
                this.ctx.beginPath();
                this.ctx.moveTo(-16, -2);
                this.ctx.quadraticCurveTo(-12, -6, 2, -4);
                this.ctx.quadraticCurveTo(12, -1, 16, 2);
                this.ctx.quadraticCurveTo(12, 6, 2, 4);
                this.ctx.quadraticCurveTo(-12, 1, -16, -2);
                this.ctx.fill();
                
                // Banana ridges (the lines on a real banana) - more detailed
                this.ctx.strokeStyle = '#E6C200';
                this.ctx.lineWidth = 1.5;
                for (let i = -2; i <= 2; i++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(-20, i * 3);
                    this.ctx.quadraticCurveTo(0, i * 3 - 3, 20, i * 3 + 2);
                    this.ctx.stroke();
                }
                
                // Banana stem (brown tip) - more detailed
                this.ctx.fillStyle = '#8B4513';
                this.ctx.beginPath();
                this.ctx.arc(-20, -2, 4, 0, Math.PI * 2);
                this.ctx.fill();
                this.ctx.fillStyle = '#654321';
                this.ctx.beginPath();
                this.ctx.arc(-20, -2, 2, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Banana bottom tip - more detailed
                this.ctx.fillStyle = '#654321';
                this.ctx.beginPath();
                this.ctx.arc(20, 3, 3, 0, Math.PI * 2);
                this.ctx.fill();
                
                this.ctx.restore();
                
                // Add sparkles around the giant banana
                for (let i = 0; i < 8; i++) {
                    const sparkleAngle = (i / 8) * Math.PI * 2 + sparkleTime;
                    const sparkleDistance = 80 + Math.sin(sparkleTime + i) * 15;
                    const sparkleX = bananaX + Math.cos(sparkleAngle) * sparkleDistance;
                    const sparkleY = bananaY + Math.sin(sparkleAngle) * sparkleDistance + bounceOffset;
                    const sparkleSize = 3 + Math.sin(sparkleTime * 2 + i) * 2;
                    
                    this.ctx.fillStyle = '#FFD700';
                    this.ctx.beginPath();
                    this.ctx.moveTo(sparkleX, sparkleY - sparkleSize);
                    this.ctx.lineTo(sparkleX + sparkleSize, sparkleY);
                    this.ctx.lineTo(sparkleX, sparkleY + sparkleSize);
                    this.ctx.lineTo(sparkleX - sparkleSize, sparkleY);
                    this.ctx.closePath();
                    this.ctx.fill();
                }
                
                // NO phone on the ground - only the one in monkey's hand
            }
            
            gameLoop() {
                // Clear canvas
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Draw background
                this.drawBackground();
                
                if (this.gameMode === 'victory') {
                    this.updateVictorySequence();
                    this.drawVictorySequence();
                } else if (this.gameMode === 'cashapp') {
                    // Handle cash app ending sequence
                    this.updateCashAppSequence();
                    this.spawnDollarRain(); // Add dollar rain during cashapp ending
                    this.updateDollarRain(); // Update dollar rain animation
                    this.drawDollarRain(); // Draw dollar rain behind everything
                    this.drawCashAppSequence();
                } else if (this.gameMode === 'winking') {
                    // Handle winking animation sequence
                    this.updateWinkSequence();
                    this.drawWinkingMonkey();
                    this.drawTheEndText();
                } else if (this.gameRunning) {
                    // Update game objects
                    this.spawnBanana();
                    this.spawnDollarBill();
                    this.spawnDollarRain(); // Continuous dollar rain animation
                    this.updateBasket();
                    this.updateBananas();
                    this.updateDollarBills();
                    this.updateDollarRain(); // Update dollar rain animation
                    this.updateParticles();
                    
                    // Update expression timer
                    if (this.expressionTimer > 0) {
                        this.expressionTimer--;
                        if (this.expressionTimer <= 0) {
                            this.monkeyExpression = 'neutral';
                        }
                    }
                    
                    // Draw game objects
                    this.drawDollarRain(); // Draw dollar rain behind everything
                    this.drawMonkey();
                    this.drawBasket();
                    this.drawBananas();
                    this.drawDollarBills();
                    this.drawParticles();
                } else {
                    // Draw static game objects
                    this.spawnDollarRain(); // Dollar rain even when not playing
                    this.updateDollarRain();
                    this.drawDollarRain(); // Draw dollar rain behind everything
                    this.drawMonkey();
                    this.drawBasket();
                    this.drawBananas();
                    this.drawParticles();
                }
                
                // Continue game loop
                requestAnimationFrame(() => this.gameLoop());
            }
        }
        
        // Start the game when page loads
        window.addEventListener('load', () => {
            new BananaCatchingGame();
        });
    </script>
</body>
</html>
